---
title: 贝叶斯滤波与平滑（1）
author: ''
date: '2020-04-04'
slug: bayesian-1-3
categories:
  - R可视乎
tags: 
  - Rplot
subtitle: ''
summary: '课程学习笔记'
authors: []
lastmod: '2020-04-04T11:12:47+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: [贝叶斯]
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>


<div id="第一章贝叶斯滤波与平滑" class="section level1">
<h1>第一章、贝叶斯滤波与平滑</h1>
<div id="应用" class="section level2">
<h2>应用</h2>
<table>
<thead>
<tr class="header">
<th align="center">应用名称</th>
<th align="center">状态量</th>
<th align="center">观测量</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">GPS</td>
<td align="center">位置、星历</td>
<td align="center">多个卫星的波达时间、星历</td>
</tr>
<tr class="even">
<td align="center">目标跟踪</td>
<td align="center">位置、速度</td>
<td align="center">传感器量测量</td>
</tr>
<tr class="odd">
<td align="center">多目标跟踪</td>
<td align="center">同上、目标数量、数据关联</td>
<td align="center">传感器数据</td>
</tr>
<tr class="even">
<td align="center">组合惯性导航</td>
<td align="center">位置、速度</td>
<td align="center">GPS、IMU</td>
</tr>
<tr class="odd">
<td align="center">传染病</td>
<td align="center">人群</td>
<td align="center">量测信息</td>
</tr>
</tbody>
</table>
<p>还有生物过程、通信、音频信号处理、随机最优控制、学习系统、物理系统。值得一提的是，随机最优控制还有时间最短、误差最小的概念在里面。</p>
</div>
<div id="起源" class="section level2">
<h2>起源</h2>
<p>维纳滤波–&gt; 卡曼滤波 –&gt; 贝叶斯滤波</p>
</div>
<div id="基于最优滤波与平滑的贝叶斯推理" class="section level2">
<h2>基于最优滤波与平滑的贝叶斯推理</h2>
<p>最优滤波和平滑被认为是统计反演问题：</p>
<p><img src="1.jpg" />
我们现在知道的是观察值<span class="math inline">\(y_{1},\dots,y_{T}\)</span>,目的是估计出<span class="math inline">\(x_{1},\dots,x_{T}\)</span>。但是观察的<span class="math inline">\(y\)</span>存在测量误差的影响。从贝叶斯的角度来说就是已知所有测量去计算所有状态的联合后验分布。理论上通过贝叶斯公式就可以得到的。</p>
<p>但是完整的后验分布公式存在一个严重的缺点：当获得新的测量值时，整个后验分布都要重新计算，而在动态估计中，这个问题很严重。随着时间步长增加，完整的后验分布维数也会增加。</p>
<p>于是我们将条件放宽，只需计满足特定状态的边缘分布时，计算量就少了一个数量级，我们将动态模型限定为<strong>马尔可夫序列</strong>。在贝叶斯滤波和平滑中，用边缘分布代替完整的联合分布。</p>
<p><strong>滤波分布</strong>：知道k前的测量值<span class="math inline">\(y_{1:k}\)</span>，计算<span class="math inline">\(x_{k}\)</span>的边缘分布。</p>
<p><span class="math display">\[p\left(\boldsymbol{x}_{k} | \boldsymbol{y}_{1: k}\right), k=1, \cdots, T\]</span></p>
<p><strong>预测分布</strong>：在测量值<span class="math inline">\(y_{1:k}\)</span>已知情况下，计算<span class="math inline">\(x_{k+n}\)</span></p>
<p><span class="math display">\[p\left(\boldsymbol{x}_{k+n} | \boldsymbol{y}_{1 : k}\right), k=1, \cdots, T, n=1,2, \cdots\]</span></p>
<p><strong>平滑分布</strong>：在测量值<span class="math inline">\(y_{1:T}\)</span>已知情况下，计算<span class="math inline">\(x_{k}\)</span></p>
<p><span class="math display">\[p\left(\boldsymbol{x}_{k} | \boldsymbol{y}_{1: T}\right), k=1, \cdots, T\]</span></p>
<p><img src="2.jpg" /></p>
</div>
<div id="贝叶斯滤波与平滑" class="section level2">
<h2>贝叶斯滤波与平滑</h2>
<p>文中列出了几种有闭型解的滤波和平滑问题。</p>
<p>由于贝叶斯最优滤波和平滑方程解比较复杂，所以会有很多数值逼近方法。</p>
<p>具体见[书上p8-9]所示(<a href="https://max.book118.com/html/2018/1215/7150201115001164.shtm" class="uri">https://max.book118.com/html/2018/1215/7150201115001164.shtm</a>)。</p>
</div>
<div id="参数估计" class="section level2">
<h2>参数估计</h2>
<p>我们假设动态模型为<strong>马尔可夫序列</strong>。</p>
<p>则参数的边缘后验分布为：
<span class="math display">\[p\left(\boldsymbol{\theta} | \boldsymbol{y}_{1, T}\right) \propto p(\boldsymbol{\theta}) \prod_{k=1}^{T} p\left(\boldsymbol{y}_{k} | \boldsymbol{y}_{1, k-1}, \boldsymbol{\theta}\right)\]</span></p>
<p>结合平滑分布公式，可得到状态和参数所有的边缘联合分布：
<span class="math display">\[p\left(\boldsymbol{x}_{k}, \boldsymbol{\theta} | \boldsymbol{y}_{1, T}\right)=p\left(\boldsymbol{x}_{k} | \boldsymbol{y}_{1, T}, \boldsymbol{\theta}\right) p\left(\boldsymbol{\theta} | \boldsymbol{y}_{1, T}\right)\]</span>
但是计算不出完整的联合后验分布。</p>
<p>为了求参数我们进行积分：</p>
<p><span class="math display">\[\begin{aligned}
p\left(\boldsymbol{x}_{k} | \boldsymbol{y}_{1, T}\right) &amp;=\int p\left(\boldsymbol{x}_{k}, \boldsymbol{\theta} | \boldsymbol{y}_{1:T}\right) \mathrm{d} \boldsymbol{\theta} \\
&amp;=\int p\left(\boldsymbol{x}_{k} | \boldsymbol{y}_{1: T}, \boldsymbol{\theta}\right) p\left(\boldsymbol{\theta} | \boldsymbol{y}_{1: T}\right) \mathrm{d} \boldsymbol{\theta}
\end{aligned}\]</span>
但是由于积分难算，我们用近似求解：使用MCMC获得参数样本，便可以得到上述积分的蒙特卡洛逼近。</p>
</div>
<div id="参考文献" class="section level2 unnumbered">
<h2>参考文献</h2>
<p>(贝叶斯滤波与平滑（1-3）)[<a href="https://blog.csdn.net/wang_jun_whu/article/details/104741553" class="uri">https://blog.csdn.net/wang_jun_whu/article/details/104741553</a>]</p>
<p><a href="https://max.book118.com/html/2018/1215/7150201115001164.shtm">贝叶斯滤波与平滑</a></p>
</div>
</div>
